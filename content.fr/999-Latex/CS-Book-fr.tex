\documentclass[letterpaper,french,twocolumn,openany]{book}
\usepackage[T1]{fontenc}    % Encodage T1 (adapté au français)
%French-specific commands
%____________________________________________________________________
% https://en.wikibooks.org/wiki/LaTeX/Special_Characters
\usepackage[french]{babel}
\usepackage[autolanguage]{numprint} % for the \nombre command
\usepackage{hyperref}   % for linking references https://en.wikibooks.org/wiki/LaTeX/Hyperlinks
\usepackage{lmodern}        % Caractères plus lisibles
\usepackage{babel}          % Réglages linguistiques (avec french)
\pagestyle{empty}           % N'affiche pas de numéro de page
\usepackage[explicit]{titlesec}  % pour modifier le style de chapitre
\usepackage{color}        % pour les coleurs de police
\usepackage[table,dvipsnames]{xcolor}  % pour les couleurs des tableaux https://en.wikibooks.org/wiki/LaTeX/Colors
\usepackage{graphicx}     % pour inclure des images
\usepackage{wrapfig}
%\usepackage[dvipsnames]{xcolor} % pour les couleurs
\usepackage{fancyhdr} % pour les entete
\usepackage{ifthen}  % branchements conditionnels
\usepackage{xpatch} 
\usepackage[export]{adjustbox}  % pour positionner des images dans la page
\usepackage{tabularx}  % pour les tableaux
\usepackage{wrapfig}   % pour le que le texte ne recouvre pas les figures/tableaux
\usepackage{stfloats}   % pour le que le texte ne recouvre pas les figures/tableaux
\usepackage{multicol}   % gestion de plusieurs colonnes (dans une cellule de tableau pas ex)
\usepackage{enumitem}   % pour la personnalisation des liste
\usepackage{parskip}     % for paragraph indenttion
\usepackage{titletoc}    % for having ToC under each chapter
%____________________________________________________________________
%%  Default Font
\usepackage[sfdefault]{cabin}
\renewcommand*\familydefault{\sfdefault} %% Only if the base font of the document is to be sans serif
\usepackage[T1]{fontenc}

%____________________________________________________________________
% page margins
% https://www.overleaf.com/learn/latex/Page_size_and_margins
% https://fr.overleaf.com/learn/latex/Single_sided_and_double_sided_documents
% https://distrib-coffee.ipsl.jussieu.fr/pub/mirrors/ctan/macros/latex/contrib/geometry/geometry.pdf
\usepackage[
  top=16mm,
  bottom=18mm,
  marginparwidth=30mm,
  marginparsep=2mm,
  outer=50mm,
  inner=20mm,
  headheight=7mm,
  headsep=7mm
  %textwidth=345pt,
]{geometry}
%____________________________________________________________________
\newcommand*{\definitchapitre}[2]{\chapter{#1 \label{#2} \definitentete{#1}}}
%____________________________________________________________________
% commande pour afficher l'image de tête de chapitre
\newcommand*{\afficheimagechapitre}[1]{
    \hspace*{-76pt}
    \ifthenelse{\equal{#1}{1}}{
        \includegraphics[width=\paperwidth]{img/CS-page4-01.png}
    }
    {
        \ifthenelse{\equal{#1}{2}}{
            \includegraphics[width=\paperwidth]{img/CS-page5-01.png}
        }
        {
            \ifthenelse{\equal{#1}{3}}{
                \includegraphics[width=\paperwidth]{img/CS-page7-01.png}
                }
                {
                    \ifthenelse{\equal{#1}{4}}{
                        \includegraphics[width=\paperwidth]{img/CS-page14-01.png}
                        }
                        {
                            \ifthenelse{\equal{#1}{5}}{
                                \includegraphics[width=\paperwidth]{img/CS-page20-01.png}
                                }
                                {
                                    \ifthenelse{\equal{#1}{6}}{
                                        \includegraphics[width=\paperwidth]{img/CS-page34-01.png}
                                        }
                                        {
                                            \ifthenelse{\equal{#1}{7}}{
                                                \includegraphics[width=\paperwidth]{img/CS-page38-01.png}
                                                }
                                                {
                                                    \ifthenelse{\equal{#1}{8}}{
                                                        \includegraphics[width=\paperwidth]{img/CS-page60-01.png}
                                                        }
                                                        {
                                                            \ifthenelse{\equal{#1}{9}}{
                                                                \includegraphics[width=\paperwidth]{img/CS-page95-01.png}
                                                                }
                                                                {
                                                                    \ifthenelse{\equal{#1}{10}}{
                                                                        \includegraphics[height=8.25cm]{img/CS-page201-01.png}
                                                                    }{
                                                                        IMAGE A DEFINIR
                                                                    }
                                                                }
                                                        }
                                                }
                                        }
                                }
                        }
                }
        }
    }
}
%____________________________________________________________________
%  Style pour les en-têtes
\newcommand*{\definitentete}[1]{
    \fancypagestyle{plain}{ %
        \fancyhf{} % remove everything
        \renewcommand{\headrulewidth}{1pt} % remove lines as well
        \renewcommand{\footrulewidth}{1pt}
        \fancyhead[RO]{#1}
        \fancyhead[LE]{CYPHER SYSTEM}
    }
}
%____________________________________________________________________
%  définition des en-têtes
\setlength{\headheight}{15.2pt}
\pagestyle{fancy}
\fancyhead[LE]{CYPHER SYSTEM}
%____________________________________________________________________-
\newcommand*{\smallcslogo}{\includegraphics[height=3mm]{img/CS-mini-logo.png}}
%  définition du style des listes de nom capacités
\newlist{abnamelist}{itemize}{1}
\setlist[abnamelist]{label={\smallcslogo}}
%____________________________________________________________________
\newcommand*{\abilitylistitem}[2]{#1 (\hyperref[#2]{\pageref{#2}})}
%____________________________________________________________________-
%  définition du style des listes de capacités (chapitre 9)
%\newlist{ablist}{itemize}{1}
%\setlist[ablist]{leftmargin=*,label={\includegraphics[height=3mm]{CS-mini-logo.png} :}}
%\setlist[ablist]{label={\includegraphics[height=3mm]{CS-mini-logo.png}}}
\newcommand*{\abilitydetaillistitem}[2]{\item \textbf{#1 :} #2}
%-------------------------------------------------------------------
%  style de paragraphe 
\newcommand*{\chapterfirstletter}[2]{\begin{wrapfigure}{l}{2mm}
    {\Huge\textcolor{#2}{\textbf{#1}}}
\end{wrapfigure}}
%----------------------------------------------------------------
% commande pour la couleur de chaque partie
\newcommand*{\textcolorpartzero}[1]{\textcolor{RedViolet}{#1}}
\newcommand*{\textcolorpartone}[1]{\textcolor{BlueViolet}{#1}}
%\newcommand*{\getcolorpart}[1]{\ifthenelse{\equal{#1}{0}}{RedViolet}{\ifthenelse{\equal{#1}{1}}{BlueViolet}{\ifthenelse{\equal{#1}{2}}{BlueViolet}{}}}}
%\newcommand*{\textcolorpart}[2]{\textcolor{\getcolorpart{#1}}{#2}}
\newcommand*{\getcolorpartone}{BlueViolet}
%  commande pour définir chaque chapitre
\newcommand*{\startchapter}[3]{\chapter{#1}
    \label{#2}
    \fancypagestyle{plain}{ %
    \fancyhf{} % remove everything
    \renewcommand{\headrulewidth}{1pt} % remove lines as well
    \renewcommand{\footrulewidth}{0pt}
    \xpretocmd\headrule{\color{#3}}{}{\PatchFailed}
    \fancyhead[RO]{\textcolor{#3}{\textsc{#1}}}
    \fancyhead[LE]{\textcolor{#3}{CYPHER SYSTEM}}
    \fancyhf[FLE,FRO]{\thepage}
}
\fancyhf{} % remove everything
\renewcommand{\headrulewidth}{1pt} % remove lines as well
\renewcommand{\footrulewidth}{0pt}
\xpretocmd\headrule{\color{#3}}{}{\PatchFailed}
\fancyhead[RO]{\textcolor{#3}{#1}}
\fancyhead[LE]{\textcolor{#3}{CYPHER SYSTEM}}
\fancyhf[FLE,FRO]{\thepage}
}
%#######################################################################
\title{CYPHER SYSTEM LIVRE DES R\`{E}GLES}
\author{Monte Cook, Bruce R. Cordell, Sean K. Reynolds}
\date{March 2019}
%#######################################################################
%     DOCUMENT START
%#######################################################################
\begin{document}
\frontmatter
%-------------------------
%  cover
\begin{titlepage}
    \centering
    \begin{figure*}
        \hspace*{-75pt}
        \vspace*{-75pt}
        \includegraphics*[height=\paperheight]{img/CS-Cover.png}    
    \end{figure*}
\end{titlepage}
%-------------------------
% blank page
%-------------------------
\mainmatter
\tableofcontents
%____________________________________________________________________
%   reset headers
\fancypagestyle{plain}{ %
    \fancyhf{} % remove everything
}
\fancyhf[FLE,FRO]{\thepage}
%#######################################################################
%   PART 0 : The CYPHER SYSTEM
%#######################################################################
\part*{LE CYPHER SYSTEM}
%____________________________________________________________________
% https://distrib-coffee.ipsl.jussieu.fr/pub/mirrors/ctan/macros/latex/contrib/titlesec/titlesec.pdf
% https://borntocode.fr/latex-personnaliser-les-titres-chapter/
%% define format for chapter
\titleformat{\chapter} % command
    [display] % shape
    {\bfseries\Large\centering} % format
    {\textcolor{RedViolet}{Chapitre \ \thechapter \\ \huge \uppercase{#1}} \\ \afficheimagechapitre{\thechapter}} % label
    {0pt} % sep
    {
        \centering
    } % before-code
    [
        \small
    ] % after-code
\titlespacing{\chapter}
    {0mm} %left
    {-0pt} %before-step
    {-10mm} %after-step
    {} %right
%____________________________________________________________________
%% define format for section
% numberless
\titleformat{name=\section,numberless}[runin] 
    {\normalfont\Large\bfseries}
    {\\ \textcolor{RedViolet} {#1}}
    {20pt}
    {\Large}
    [\\]
% paragraphe indentation
\setlength{\parindent}{3mm}
%#######################################################################
\include{./tex/Chapter-01.tex}
\include{./tex/Chapter-02.tex}
\include{./tex/Chapter-03.tex}
%#######################################################################
%    PART 1 : CHARACTERS
%#######################################################################
\part*{\uppercase{Personnages}}
%____________________________________________________________________
% https://distrib-coffee.ipsl.jussieu.fr/pub/mirrors/ctan/macros/latex/contrib/titlesec/titlesec.pdf
% https://borntocode.fr/latex-personnaliser-les-titres-chapter/
%% define format for chapter for part 2
\titleformat{\chapter} % command
    [display] % shape
    {\bfseries\Large\centering} % format
    {\textcolor{BlueViolet}{Chapitre \ \thechapter \\ \huge \uppercase{#1}} \\ \afficheimagechapitre{\thechapter}} % label
    {0.5ex} % sep
    {
        \centering
    } % before-code
    [
    \centering
    ] % after-code
    \titlespacing*{\chapter}
    {0mm} %left
    {-0pt} %before-step
    {0mm} %after-step
    {} %right
%____________________________________________________________________
%% define format for section
% \titleformat{\section} % Command to format section titles
% {\normalfont\Large\bfseries} % Format: normal font, large size, bold
% {\thesection}{1em} % Label format: section number followed by 1em space
% {} % Before the title
% [\titlerule] % After the title: horizontal line

% \titleformat{\section} % command
%     [display] % shape
%     {\bfseries\Large} % format
%     {\textcolor{BlueViolet}{#1}} % label
%     {0.5ex} % sep
%     {
%         \Large
%     } % before-code

%     \titlespacing*{\section}
%     {0mm} %left
%     {-0pt} %before-step
%     {0mm} %after-step
%     {} %right
%____________________________________________________________________
% numberless
\titleformat{name=\section,numberless}[runin] 
    {\normalfont\Large\bfseries}
    {\\ \textcolor{BlueViolet} {#1}}
    {20pt}
    {\Large}
    [\\]
%____________________________________________________________________
%% define format for subsection
% numberless
\titleformat{name=\subsection,numberless}[runin] 
    {\normalfont\large\bfseries}
    {\\ \textcolor{BlueViolet} {#1}}
    {20pt}
    {\large}
    [\\]
%#######################################################################
%\MiniToC % table of content for part 1
\include{./tex/Chapter-04.tex}
\include{./tex/Chapter-05.tex}
\include{./tex/Chapter-06.tex}
\include{./tex/Chapter-07.tex}
\include{./tex/Chapter-08.tex}
\include{./tex/Chapter-09.tex}
\include{./tex/Chapter-10.tex}
%#######################################################################
%   PART 2 Les règles
%#######################################################################
\part*{\uppercase{Les Règles}}
%____________________________________________________________________
% https://distrib-coffee.ipsl.jussieu.fr/pub/mirrors/ctan/macros/latex/contrib/titlesec/titlesec.pdf
% https://borntocode.fr/latex-personnaliser-les-titres-chapter/
%% define format for chapter for part 2
\titleformat{\chapter} % command
    [display] % shape
    {\bfseries\Large\centering} % format
    {\textcolor{RawSienna}{Chapitre \ \thechapter \\ \huge \uppercase{#1}} \\ \afficheimagechapitre{\thechapter}} % label
    {0.5ex} % sep
    {
        \centering
    } % before-code
    [
    \centering
    ] % after-code
    \titlespacing*{\chapter}
    {0mm} %left
    {-0pt} %before-step
    {0mm} %after-step
    {} %right
%____________________________________________________________________
%% define format for section
% numberless
\titleformat{name=\section,numberless}[runin] 
    {\normalfont\Large\bfseries}
    {\\ \textcolor{BlueVRawSiennaiolet} {#1}}
    {20pt}
    {\Large}
    [\\]
%____________________________________________________________________
%% define format for subsection
    \titleformat{\subsection} % command
    [display] % shape
    {\bfseries\large} % format
    {\textcolor{RawSienna}{#1}} % label
    {0.5ex} % sep
    {
        \large
    } % before-code

    \titlespacing*{\subsection}
    {0mm} %left
    {-0pt} %before-step
    {0mm} %after-step
    {} %right
%____________________________________________________________________
% numberless
\titleformat{name=\subsection,numberless}[runin] 
    {\normalfont\large\bfseries}
    {\\ \textcolor{RawSienna} {#1}}
    {20pt}
    {\large}
    [\\]
%#######################################################################

%#######################################################################
%   Part 3 Les Genres
%#######################################################################
\part*{\uppercase{Les Genres}}
%____________________________________________________________________
% https://distrib-coffee.ipsl.jussieu.fr/pub/mirrors/ctan/macros/latex/contrib/titlesec/titlesec.pdf
% https://borntocode.fr/latex-personnaliser-les-titres-chapter/
%% define format for chapter for part 3
\titleformat{\chapter} % command
    [display] % shape
    {\bfseries\Large\centering} % format
    {\textcolor{OliveGreen}{Chapitre \ \thechapter \\ \huge \uppercase{#1}} \\ \afficheimagechapitre{\thechapter}} % label
    {0.5ex} % sep
    {
        \centering
    } % before-code
    [
    \centering
    ] % after-code
    \titlespacing*{\chapter}
    {0mm} %left
    {-0pt} %before-step
    {0mm} %after-step
    {} %right
%____________________________________________________________________
%% define format for section
% \titleformat{\section} % Command to format section titles
% {\normalfont\Large\bfseries} % Format: normal font, large size, bold
% {\thesection}{1em} % Label format: section number followed by 1em space
% {} % Before the title
% [\titlerule] % After the title: horizontal line

% \titleformat{\section} % command
%     [display] % shape
%     {\bfseries\Large} % format
%     {\textcolor{BlueViolet}{#1}} % label
%     {0.5ex} % sep
%     {
%         \Large
%     } % before-code

%     \titlespacing*{\section}
%     {0mm} %left
%     {-0pt} %before-step
%     {0mm} %after-step
%     {} %right
%____________________________________________________________________
% numberless
\titleformat{name=\section,numberless}[runin] 
    {\normalfont\Large\bfseries}
    {\\ \textcolor{OliveGreen} {#1}}
    {20pt}
    {\Large}
    [\\]
%____________________________________________________________________
%% define format for subsection
    % \titleformat{\subsection} % command
    % [display] % shape
    % {\bfseries\large} % format
    % {\textcolor{OliveGreen}{#1}} % label
    % {0.5ex} % sep
    % {
    %     \large
    % } % before-code

    % \titlespacing*{\subsection}
    % {0mm} %left
    % {-0pt} %before-step
    % {0mm} %after-step
    % {} %right
%____________________________________________________________________
% numberless
\titleformat{name=\subsection,numberless}[runin] 
    {\normalfont\large\bfseries}
    {\\ \textcolor{OliveGreen} {#1}}
    {20pt}
    {\large}
    [\\]
%#######################################################################
%#######################################################################
%   Part 4 Maîtriser Le Jeu
%#######################################################################
\part*{\uppercase{Maîtriser le Jeu}}
%____________________________________________________________________
% https://distrib-coffee.ipsl.jussieu.fr/pub/mirrors/ctan/macros/latex/contrib/titlesec/titlesec.pdf
% https://borntocode.fr/latex-personnaliser-les-titres-chapter/
%% define format for chapter for part 4
\titleformat{\chapter} % command
    [display] % shape
    {\bfseries\Large\centering} % format
    {\textcolor{ForestGreen}{Chapitre \ \thechapter \\ \huge \uppercase{#1}} \\ \afficheimagechapitre{\thechapter}} % label
    {0.5ex} % sep
    {
        \centering
    } % before-code
    [
    \centering
    ] % after-code
    \titlespacing*{\chapter}
    {0mm} %left
    {-0pt} %before-step
    {0mm} %after-step
    {} %right
%____________________________________________________________________
%% define format for section
% \titleformat{\section} % Command to format section titles
% {\normalfont\Large\bfseries} % Format: normal font, large size, bold
% {\thesection}{1em} % Label format: section number followed by 1em space
% {} % Before the title
% [\titlerule] % After the title: horizontal line

% \titleformat{\section} % command
%     [display] % shape
%     {\bfseries\Large} % format
%     {\textcolor{BlueViolet}{#1}} % label
%     {0.5ex} % sep
%     {
%         \Large
%     } % before-code

%     \titlespacing*{\section}
%     {0mm} %left
%     {-0pt} %before-step
%     {0mm} %after-step
%     {} %right
%____________________________________________________________________
% numberless
\titleformat{name=\section,numberless}[runin] 
    {\normalfont\Large\bfseries}
    {\\ \textcolor{ForestGreen} {#1}}
    {20pt}
    {\Large}
    [\\]
%____________________________________________________________________
%% define format for subsection
    % \titleformat{\subsection} % command
    % [display] % shape
    % {\bfseries\large} % format
    % {\textcolor{ForestGreen}{#1}} % label
    % {0.5ex} % sep
    % {
    %     \large
    % } % before-code

    % \titlespacing*{\subsection}
    % {0mm} %left
    % {-0pt} %before-step
    % {0mm} %after-step
    % {} %right
%____________________________________________________________________
% numberless
\titleformat{name=\subsection,numberless}[runin] 
    {\normalfont\large\bfseries}
    {\\ \textcolor{ForestGreen} {#1}}
    {20pt}
    {\large}
    [\\]
%#######################################################################

\backmatter
\end{document}

